{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to my Cloud SOC Wiki","text":""},{"location":"#disclaimer","title":"Disclaimer","text":"<p>This is my personal wiki that is based on my own experience working in Security Operations, here are some key points:</p> <ul> <li>This is multi-cloud so there will be content on the 3 major CSPs with the amount of exposure to each being: Azure &gt; AWS &gt; GCP</li> <li>You will notice that there is no windows content, and that is by design. I haven't worked with windows in over 4 years.</li> <li>I try not to reinvent the wheel as I gather information from people smarter than I am.</li> </ul>"},{"location":"#under-construction","title":"UNDER CONSTRUCTION","text":""},{"location":"AWS/","title":"AWS","text":""},{"location":"AWS/#logs","title":"Logs","text":"CloudTrail <p>API Calls.</p> <ul> <li>JSON format</li> <li>Stored for 90 days (management events by default)</li> <li>S3 bucket configuration available</li> </ul> <p>Trails.</p> <ul> <li>Read/write events</li> <li>Management/data/insight events</li> <li>Saved to a specified bucket every 5 minutes</li> <li>Optional prefix for all stored logs</li> <li>Not real time - within 15 minutes</li> <li>5 trail limit per account per region</li> </ul> <p>Management Events - default events, describe api calls to AWS services such as create, describe, update, list, and delete.</p> <p>Data Events - Data Plane operations. API actions on S3 objects, can also track Lambda functions. Really noisy</p> <p>Insight Events - collect Write Management Events</p> VPC Flow Logs"},{"location":"AWS/#cloudwatch","title":"CloudWatch","text":""},{"location":"AWS/#cloudwatch-logs","title":"CloudWatch Logs","text":""},{"location":"AWS/#fields-for-investigation","title":"Fields for Investigation","text":""},{"location":"AWS/#who","title":"Who","text":"<ul> <li>userIdentity.arn</li> <li>sourceIPAddress</li> <li>userAgent</li> </ul>"},{"location":"AWS/#what","title":"What","text":"<ul> <li>accountId</li> <li>eventSource</li> <li>eventName</li> <li>requestParameters</li> </ul>"},{"location":"AWS/#when","title":"When","text":"<ul> <li>eventTime</li> <li>awsRegion</li> </ul>"},{"location":"AWS/#how","title":"How","text":"<ul> <li>eventType</li> <li>userIdentity.type</li> <li>userIdentity.accessKeyId</li> <li>userIdentity.invokedBy</li> </ul>"},{"location":"AWS/#result","title":"Result","text":"<ul> <li>eventID</li> <li>errorCode</li> <li>responseElements</li> <li>sharedEventID</li> </ul>"},{"location":"AWS/#resources","title":"Resources","text":"<ul> <li>https://traildiscover.cloud/</li> </ul>"},{"location":"Azure/","title":"Azure","text":""},{"location":"Azure/#logs","title":"Logs","text":"Azure Activity Logs <p>API calls.</p> <ul> <li>Create, update, and delete events. (no read events)</li> <li>JSON Format</li> </ul> <p>Fields for Investigation</p> <ul> <li>eventTimestamp</li> <li>authorization.action</li> <li>caller</li> <li>claims.ipaddr</li> <li>claims.name</li> <li>correlationId</li> <li>resourceId</li> <li>status.value</li> <li>Operation Name</li> <li>Status</li> <li>Subscription</li> <li>Event initiated by</li> <li>Resource group, Resource type, Resource</li> </ul> Entra ID Audit &amp; Sign-in LogsDiagnostic LogsNSG Flow LogsTBDEntra ID <ol> <li>TBD</li> </ol>"},{"location":"Azure/#resources","title":"Resources","text":"<ul> <li>https://github.com/Cloud-Architekt/AzureAD-Attack-Defense</li> <li>https://www.xintra.org/blog/tokens-in-entra-id-guide</li> </ul>"},{"location":"Azure/#kql","title":"KQL","text":"<ul> <li>https://github.com/Bert-JanP/Hunting-Queries-Detection-Rules</li> </ul>"},{"location":"CFIR/","title":"CFIR","text":""},{"location":"CFIR/#vm-snapshots","title":"VM Snapshots","text":"<ul> <li>Full read only copy of virtual hard drive</li> <li>Same region</li> <li>Created at hypervisor level </li> <li>Can be taken while VM is running or powered off</li> <li>Available in all 3 major CSPs</li> <li>Typically attached to seperate forensic workstation for analysis</li> <li></li> </ul>"},{"location":"CFIR/#aws-cfir","title":"AWS CFIR","text":"<ul> <li>https://www.invictus-ir.com/news/cloud-native-incident-response-in-aws---part-ii</li> </ul>"},{"location":"CFIR/#azure-cfir","title":"Azure CFIR","text":"<ul> <li>https://www.cadosecurity.com/blog/azure-run-command-forensics</li> </ul>"},{"location":"CFIR/#gcp-cfir","title":"GCP CFIR","text":"<ul> <li>https://medium.com/google-cloud/google-cloud-incident-response-cheat-sheet-dfde9054ac16</li> </ul>"},{"location":"CFIR/#resources","title":"Resources","text":"<ul> <li>https://comparecloud.in/</li> <li></li> </ul>"},{"location":"CTI/","title":"CTI","text":""},{"location":"CTI/#favorite-sources","title":"Favorite Sources","text":"<ul> <li>Wiz</li> <li>Sysdig</li> <li>Aqua</li> <li>Unit42</li> <li>Red Canary</li> </ul>"},{"location":"CTI/#links","title":"Links","text":"<pre><code>https://www.trendmicro.com/en_us/research.html\nhttps://www.aquasec.com/research/\nhttps://redcanary.com/blog/\nhttps://sysdig.com/threat-research/\nhttps://www.wiz.io/blog\nhttps://www.wiz.io/cloud-threat-landscape\nhttps://unit42.paloaltonetworks.com/category/cloud-cybersecurity-research/\nhttps://www.paloaltonetworks.com/prisma/cloud/research/\nhttps://thedfirreport.com/\n</code></pre>"},{"location":"Detection%20Engineering/","title":"Detection Engineering","text":""},{"location":"Detection%20Engineering/#de-philosophies","title":"DE Philosophies","text":"<ul> <li> <p>https://br0k3nlab.com/resources/axioms-of-security-and-rule-based-capabilities/</p> </li> <li> <p>https://br0k3nlab.com/resources/zen-of-security-rules/</p> </li> </ul> <p></p>"},{"location":"Detection%20Engineering/#cloud-focused-mitre-tactics-techniques","title":"Cloud Focused MITRE Tactics &amp; Techniques","text":"<p>Rather than document the entire MITRE framework I thought I would highlight a few cloud specific IDs.</p> Discovery - TA0007 <p>Learning information about your environment.</p> <pre><code>Cloud Service Discovery (T1526) - using a cloud API service to identify what services are available.\nCloud Infrastructure Discovery (T1580) - Looking for resources that are a part of the service.\nCloud Storage Object Discovery (T1619) - enumerating objects within cloud storage.\n</code></pre> Defense Evasion - TA0005 <p>Modify Cloud Compute Infrastructure (T1578) - modify compute service to evade defense.</p>"},{"location":"Detection%20Engineering/#detection-as-code-resources","title":"Detection as Code Resources","text":"<pre><code>https://www.datadoghq.com/blog/datadog-detection-as-code/#:~:text=Our%20Threat%20Detection%20team%20uses,runtimes%20(CSM)%2C%20respectively\n\nhttps://www.elastic.co/blog/detections-as-code-elastic-security\n\nhttps://panther.com/cyber-explained/detections-as-code/#get-started\n\nhttps://www.googlecloudcommunity.com/gc/Community-Blog/Getting-Started-with-Detection-as-Code-and-Chronicle-Security/ba-p/702154\n</code></pre>"},{"location":"Detection%20Engineering/#detection-rule-repositories","title":"Detection Rule Repositories","text":"<pre><code>https://github.com/SigmaHQ/sigma/tree/master/rules\nhttps://github.com/elastic/detection-rules/tree/main/rules\nhttps://github.com/splunk/security_content/tree/develop/detections\nhttps://github.com/panther-labs/panther-analysis/tree/develop/rules\n</code></pre>"},{"location":"Detection%20Engineering/#general-de-blogs-resources","title":"General DE Blogs &amp; Resources","text":"<pre><code>https://www.elastic.co/security-labs/topics/detection-science\nhttps://www.elastic.co/security-labs/primer-on-persistence-mechanisms\nhttps://www.elastic.co/security-labs/sequel-on-persistence-mechanisms\nhttps://redcanary.com/blog/linux-security/detection-engineer-guide-to-linux/\nhttps://www.wiz.io/blog/cloud-logging-tips-and-tricks\nhttps://chesterlebron.blogspot.com/2024/08/my-methodology-to-aws-detection-engineering-part-1.html\nhttps://research.splunk.com/\nhttps://lolol.farm/\n</code></pre>"},{"location":"Detection%20Engineering/#siem-engineering","title":"SIEM Engineering","text":"Parsing <p>https://regexr.com/</p>"},{"location":"Detection%20Engineering/#threat-modeling","title":"Threat Modeling","text":""},{"location":"GCP/","title":"GCP","text":""},{"location":"GCP/#logs","title":"Logs","text":"<ul> <li>VPC Flow Logs</li> </ul> TBD <ol> <li>TBD</li> </ol>"},{"location":"Kubernetes/","title":"Kubernetes","text":""},{"location":"Kubernetes/#kubernetes-architecture","title":"Kubernetes Architecture","text":""},{"location":"Kubernetes/#threat-matrix","title":"Threat Matrix","text":"<ul> <li>https://microsoft.github.io/Threat-Matrix-for-Kubernetes/</li> <li>https://kubenomicon.com/</li> <li></li> </ul>"},{"location":"Kubernetes/#logs","title":"Logs","text":"LogsBlogs <ul> <li>Kubernetes Audit Logs</li> </ul> <ol> <li>https://grahamhelton.com/blog/k8slogs/</li> </ol>"},{"location":"Kubernetes/#resources","title":"Resources","text":""},{"location":"Linux/","title":"Linux","text":""},{"location":"Linux/#auditd-rules","title":"Auditd Rules","text":"<ul> <li>https://github.com/Neo23x0/auditd/blob/master/audit.rules</li> <li>https://gitlab.com/ndaal_open_source/ndaal_public_auditd/-/blob/main/dataset/audit_best_practices.rules?ref_type=heads</li> <li></li> </ul>"},{"location":"Linux/#logs","title":"Logs","text":""},{"location":"Linux/#host","title":"Host","text":""},{"location":"Linux/#network","title":"Network","text":""},{"location":"Linux/#baselining","title":"Baselining","text":"TBD <ol> <li>TBD</li> </ol>"},{"location":"Linux/#linux-dfir","title":"Linux DFIR","text":"<ul> <li>https://www.linkedin.com/pulse/linux-ir-key-forensic-artifacts-incident-responders-taz-wake-asmbe/</li> <li>https://sandflysecurity.com/blog/tag/linux-forensics/</li> </ul>"},{"location":"Linux/#containers-primer","title":"Containers - Primer","text":"<pre><code>Images\n</code></pre>"},{"location":"Offense/","title":"Offense","text":""},{"location":"Offense/#general-cloud-pentesting-notes","title":"General Cloud Pentesting notes","text":""},{"location":"Offense/#attacking-saas","title":"Attacking SaaS","text":"<ul> <li>Exploits could be out of scope </li> <li>Generally focused on data and the access to that data</li> <li>Backdooring and abusing tokens abuse like OAuth</li> <li>MFA bypass</li> </ul>"},{"location":"Offense/#attacking-paas","title":"Attacking PaaS","text":"<ul> <li>Focuses on Applications</li> </ul>"},{"location":"Offense/#attacking-iaas","title":"Attacking IaaS","text":"<ul> <li>Compute, Storage, Network all in scope</li> </ul>"},{"location":"Offense/#cloud-recon-discovery","title":"Cloud Recon &amp; Discovery","text":"<p>Domains and hosts * Passive techniques such as Google Cache, Certificate Transparency Reports * Active techniques such as brute forcing with wordlists and DNS scanning</p> <p>Some Tools for Domain and Host recon * gau * OTX * crtsh * hunters.io * shodan * securitytrails * intelX * dehashed * DNSdb</p> <p>Subdomain Hijacking * CNAME record that was created for something and never cleaned up (dangling dns record)</p> <p>Wordlist Patterns * Can utilize to discover services </p> <p>Figure out cloud providers - Leverage DNS info, tools like builtwith, public websites, any other OSINT data.</p> <p>Azure Recon - AADInternals</p> <p>Domain Enum tools: * subfinder * dnsx * puredns * OWASP amass * MassDNS</p>"},{"location":"Offense/#cloud-scanning","title":"Cloud Scanning","text":"<p>Identify IP ranges for provider and scan for target discovery. Azure, AWS, and GCP all publish their IP addresses. Can use jq to parse.</p>"},{"location":"Offense/#azure-attacks","title":"Azure Attacks","text":""},{"location":"Offense/#aws-attacks","title":"AWS Attacks","text":""},{"location":"Offense/#gcp-attacks","title":"GCP Attacks","text":"<p>Data Exfiltration no tools - gcloud and gsutil</p> <p>How to detect</p> <p>Check the GCP audit logs</p>"},{"location":"Offense/#kubernetes-attacks","title":"Kubernetes Attacks","text":""},{"location":"Offense/#linux-attacks","title":"Linux Attacks","text":""},{"location":"Offense/#rootkits","title":"Rootkits","text":""},{"location":"Offense/#container-attacks","title":"Container Attacks","text":""},{"location":"Offense/#resources","title":"Resources","text":"<ul> <li>https://github.com/RoseSecurity/Red-Teaming-TTPs</li> <li>https://github.com/dafthack/CloudPentestCheatsheets/?tab=readme-ov-file</li> <li>https://github.com/RhinoSecurityLabs/pacu</li> <li>https://www.daehee.com/blog/scan-aws-ip-ssl-certificates/</li> </ul>"},{"location":"Purple%20Teaming/","title":"Purple Teaming","text":""},{"location":"Purple%20Teaming/#adversary-emulation-tools","title":"Adversary Emulation Tools","text":"<pre><code>Stratus Red Team - https://github.com/DataDog/stratus-red-team\nAtomic Red Team - https://github.com/redcanaryco/atomic-red-team\nPANIX - https://github.com/Aegrah/PANIX\nGrimoire - https://github.com/DataDog/grimoire\n</code></pre> <ul> <li>VECTR</li> <li>PurpleCloud</li> <li>Caldera</li> </ul>"},{"location":"Purple%20Teaming/#resources","title":"Resources","text":"<p>https://github.com/iknowjason/PurpleCloud</p>"},{"location":"SOC%20Optimization/","title":"SOC Optimization","text":""},{"location":"SOC%20Optimization/#soar","title":"SOAR","text":""},{"location":"SOC%20Optimization/#efficiency","title":"Efficiency","text":"<p>Anything that has been or can be useful to me dealing with cloud SOC duties.</p>"},{"location":"SOC%20Optimization/#jq-json-parser","title":"jq - JSON parser","text":"<ul> <li>lightweight CLI tool</li> <li>Makes JSON easier to work with and visualize</li> <li>Similar to sed, can pipe with other commands through STDOUT</li> <li>Can change JSON data by filtering, slicing, mapping, and transforming</li> </ul>"},{"location":"SOC%20Optimization/#metrics","title":"Metrics","text":""},{"location":"SOC%20Optimization/#gen-ai-use-cases","title":"Gen AI Use Cases","text":"Incident Response <ul> <li>Iterative Prompting</li> <li>Scripting</li> <li></li> </ul> Security Operations <ul> <li>AI analysis in playbooks</li> <li></li> </ul> Detection Engineering <ul> <li>Use case development</li> </ul>"},{"location":"SOC%20Optimization/#resources","title":"Resources","text":"<ul> <li>https://www.googlecloudcommunity.com/gc/SecOps-SOAR/Part-1-Dipping-Your-Toe-into-SOAR-Understanding-the-Basics/td-p/717159</li> <li>https://github.com/jqlang/jq</li> <li>https://www.mockaroo.com/</li> <li>https://redcanary.com/blog/security-operations/genai-identity-threat-detection/</li> <li>https://medium.com/@dylanhwilliams/utilizing-generative-ai-and-llms-to-automate-detection-writing-5e4ea074072e</li> <li>https://redcanary.com/blog/security-operations/genai-security-operations/</li> </ul>"},{"location":"SOC%20Optimization/#helpful-cloud-tools","title":"Helpful cloud tools","text":"<ul> <li>https://github.com/duo-labs/cloudmapper</li> <li>https://github.com/PrateekKumarSingh/AzViz</li> <li>https://cloud.google.com/network-intelligence-center/docs/network-topology/concepts/overview</li> <li></li> </ul>"},{"location":"Threat%20Hunting/","title":"Threat Hunting","text":""},{"location":"Threat%20Hunting/#azure","title":"Azure","text":"<ul> <li>https://cthfm-azure.gitbook.io/azure</li> </ul>"},{"location":"Threat%20Hunting/#aws","title":"AWS","text":""},{"location":"Threat%20Hunting/#gcp","title":"GCP","text":""},{"location":"Threat%20Hunting/#kubernetes","title":"Kubernetes","text":""},{"location":"Threat%20Hunting/#linux","title":"Linux","text":""},{"location":"Threat%20Hunting/#resources","title":"Resources","text":"<ul> <li>https://media.defense.gov/2024/Mar/07/2003407864/-1/-1/0/CSI_CloudTop10-Logs-for-Effective-Threat-Hunting.PDF</li> <li>https://www.splunk.com/en_us/blog/security/threat-hunting-resources-tasks.html</li> <li>https://pberba.github.io/security/2021/11/22/linux-threat-hunting-for-persistence-sysmon-auditd-webshell/</li> <li>https://pberba.github.io/security/2021/11/23/linux-threat-hunting-for-persistence-account-creation-manipulation/#introduction</li> <li>https://medium.com/verint-cyber-engineering/linux-threat-hunting-primer-part-ii-69484f58ac92</li> <li></li> </ul>"}]}